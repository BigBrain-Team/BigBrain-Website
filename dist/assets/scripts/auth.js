firebase.initializeApp({apiKey:"AIzaSyC0yaoAE6qt1oEzHT4ueZZUrNFMN-3U8nE",authDomain:"bigbrain-c56d1.firebaseapp.com",databaseURL:"https://bigbrain-c56d1.firebaseio.com",projectId:"bigbrain-c56d1",storageBucket:"bigbrain-c56d1.appspot.com",messagingSenderId:"126863628981",appId:"1:126863628981:web:f777031fa40de4be37fcfc",measurementId:"G-7VYVV8F7ZH"}),firebase.analytics();const auth=firebase.auth(),db=firebase.firestore();!function(){function e(e){$("title").text(`BigBrain | Me (${e.displayName})`),$("#log").text(`Hello, ${e.displayName}.`);let t=e.photoURL;t||(t="https://www.searchpng.com/wp-content/uploads/2019/02/Men-Profile-Image-715x657.png"),$("#pfp").attr("src",t),$("#newname-field").attr("placeholder",e.displayName),$("#photourl-field").attr("placeholder","default")}auth.onAuthStateChanged(t=>{t?document.getElementById("me")?e(t):document.getElementById("navbar-title")?function(e){$("#navbar-title").text(e.displayName);const t=db.collection("users").doc(e.uid).collection("courseData").doc(getCourseID());t.get().then((function(e){e.exists?(finishedLessonsLocal=e.data().finishedLessons,finishedLessonsLocal.forEach(finishLesson)):(console.log("Creating database for user..."),t.set({finishedLessons:[]}).then((function(){console.log("Creation success!")})))})).catch((function(e){alert("Error: "+e)}))}(t):document.getElementById("login-form")?window.location.href="../me":($("#nav-btn").parent().parent().attr("href","/me"),$("#nav-btn").text("Account")):(document.getElementById("me")&&(window.location.href="/login"),(document.getElementById("app")||document.querySelector("main"))&&(window.location.href="/login"),document.getElementById("creator")&&(window.location.href="/login"))});const t=document.querySelector("#login-form");t&&t.addEventListener("submit",e=>{e.preventDefault();const n=t.email.value,o=t.pswd.value;auth.signInWithEmailAndPassword(n,o).catch(e=>{console.log(e);let t=e.message;const n=e.code;"auth/user-not-found"==n?t="Hmmm...looks like this user doesn't exist.":"auth/wrong-password"==n&&(t="Incorrect password."),$("#log").text(t)})});const n=document.querySelector("#signup-form");n&&n.addEventListener("submit",e=>{e.preventDefault();const t=n.email.value,o=n.pswd.value,a=n.name.value;auth.createUserWithEmailAndPassword(t,o).then(()=>{auth.currentUser.updateProfile({displayName:a}).then(()=>{window.location.href="/me"}).catch(e=>{$("#log").text(e.message),alert(e)})}).catch(e=>{console.log(e),$("#log").text(e.message)})}),document.querySelector("#logout")&&logout.addEventListener("click",()=>{auth.signOut().then(()=>{console.log("Signed Out!"),window.location.href="/"})});const o=document.querySelector("#name-change");o&&o.addEventListener("submit",t=>{t.preventDefault();const n=o["newname-field"].value;""!=n&&(n.length>=3?auth.currentUser.updateProfile({displayName:n}).then(()=>{console.log("Name changed success!"),e(auth.currentUser),o.reset(),window.location.href="#home"}).catch(e=>{$("#namechange-log").text(e.message)}):$("#namechange-log").text("At least three charachters."))});const a=document.querySelector("#pfp-change");a&&a.addEventListener("submit",t=>{t.preventDefault();let n=a["photourl-field"].value;""==n&&(n="https://www.searchpng.com/wp-content/uploads/2019/02/Men-Profile-Image-715x657.png"),auth.currentUser.updateProfile({photoURL:n}).then(()=>{console.log("Photo changed success!"),e(auth.currentUser),a.reset(),window.location.href="#home"}).catch(e=>{$("#photochange-log").text(e.message)})});const s=document.querySelector("#delete-account");s&&s.addEventListener("submit",e=>{e.preventDefault();const t=s["delete-field"].value;auth.signInWithEmailAndPassword(auth.currentUser.email,t).then(()=>{auth.currentUser.delete().catch(e=>{$("#delete-log").text(e.code)})}).catch(e=>{"auth/wrong-password"==e.code?$("delete-label").text("Incorrect password."):alert("Something went terribly wrong! Please report this to us:\n"+e)})})}();